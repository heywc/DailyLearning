<!--
 * @Author: heywc “1842347744@qq.com”
 * @Date: 2023-01-12 11:39:13
 * @LastEditors: heywc “1842347744@qq.com”
 * @LastEditTime: 2023-01-12 17:49:26
 * @FilePath: /DailyLearning/demo/2023/实现hash路由模式.html
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>实现hash路由模式</title>
    <style>
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html,
        body{
            height: 100%;
        }
        #content{
            height: calc(100vh - 50px);
        }
        #nav{
            height: 50px;
            display: flex;
            align-items: center;
        }
        #nav a{
            width: 25%;
        }
    </style>
</head>
<body>
    <nav id="nav">
        <a href="#/">首页</a>
        <a href="#/shop">商城</a>
        <a href="#/shopping-cart">购物车</a>
        <a href="#/mine">我的</a>
    </nav>
    <main id="content">内容</main>
</body>
<script>
    class VueRouter{
        constructor(routes=[]) {
            this.routes = routes, // 路由映射
            this.currentHash = '', // 当前路由映射
            this.refresh = this.refresh.bind(this),
            window.addEventListener('load', this.refresh, false)
            window.addEventListener('hashchange', this.refresh, false)
        }
        // 获取hash
        getUrlPath(url) {
            return url.indexOf('#') >= '0' ? url.slice(url.indexOf('#') + 1) : '/'
        }
        // 重置页面（刷新｜点击模块）
        refresh(event) {
            let newHash = '';
            if(event.newURL) {
                newHash = this.getUrlPath(event.newURL || '')
            } else {
                newHash = this.getUrlPath(window.location.hash)
            }
            this.currentHash = newHash;
            this.matchComponent()
        }
        matchComponent() {
            let curRoute = this.routes.find(route => route.path === this.currentHash);
            if(!curRoute) {
                // 当前url中的hash不存在的时候，默认取第一个; 具体根据业务逻辑走
                curRoute = this.routes.find(route => route.path === '/');
            }
            const { component } = curRoute;
            document.querySelector('#content').innerHTML = component
        }
    }
    const router =  new VueRouter([
        {
            path:'/',
            name: 'home',
            component: '<div>首页内容<div>'
        },
        {
            path:'/shop',
            name: 'shop',
            component: '<div>商城内容<div>'
        },
        {
            path:'/shopping-cart',
            name: 'shopping-cart',
            component: '<div>购物车内容<div>'
        },
        {
            path:'/mine',
            name: 'mine',
            component: '<div>我的内容<div>'
        }
    ])
</script>
</html>